<!DOCTYPE HTML>
<html>
    <!--
    Izdelajte igro Dama za dva človeška igralca. Dama se igra s krogci na šahovnici velikosti 8 × 8 polj.
    Vsak igralec prične igro z 12 krogci, ki so razvrščeni na črna polja v treh vrsticah 
    (en igralec na enem, drugi
    ,na drugem koncu šahovnice). 
    Igralca izmenično premikata krogce enega za drugim. Krogec se lahko premakne za največ eno polje v diagonalni smeri.
    Premik za več polj je možen samo takrat, ko se preskoči nasprotnikov krogec in je to moč storiti tudi v naslednji potezi. 
    S preskakovanjem krogcev odstranjujemo nasprotnikove krogce.
    Premikanje krogcev je možno samo naprej. kadar krogec doseže nasprotnikov rob šahovnice, se spremeni v damo, ki se lahko premika tudi diagonalno nazaj.
    Cilj igre je odstraniti čim več ali vse nasprotnikove krogce. Natančnejša navodila si poglejte na spletu. 
    Igralec lahko ponudi predajo ali neodločen rezultat, nasprotnik to sprejme ali zavrne
    -->
    <head>
        <meta charset="UTF-8">
        <title>Dama</title>
        <meta name="viewport" content="width=device-width,initial-scale=1"/>
        <!--  <link rel="stylesheet" href="css/themes/default/jquery.mobile-1.4.5.min.css">
       
          <script src="js/jquery.mobile-1.4.5.min.js"></script>-->
        <script src="js/jquery.js"></script>

        <script type="text/javascript" charset="utf-8" src="cordova.js"></script>  
        <link rel="stylesheet" href="css/style.css">
        <script>
            var na_vrsti = 1; //igralce na vrsti
            $(document).bind("mobileinit", function() {
                $.mobile.touchOverflowEnabled = true;
            });
            function na_vrsti_display() {
                if (na_vrsti === 1)
                    $("#igralec").html("BELI");

                else
                    $("#igralec").html("ČRNI");

            }


            function menu_show()
            {
                if ($("#menu").attr("data-displayed") === "0")
                {
                    $("#menu").slideToggle('slow', function() {
                    });

                    $("#menu").css('z-index', 11);
                    $("#menu").attr("data-displayed", "1");
                }
                else
                {
                    $("#menu").slideToggle('slow', function() {
                    });

                    setTimeout(500, function() {
                        $("#menu").css('z-index', -20);
                    });
                    $("#menu").attr("data-displayed", "0");
                }
            }
            function init() {
                document.addEventListener("deviceready", startup, false);
            }
            function startup() {
                document.addEventListener("menubutton", doMenu, false);
            }
            function doMenu() {
                menu_show();
            }

            function doOnOrientationChange()
            {
                switch (window.orientation)
                {
                    case -90:
                    case 90:
                        // alert('landscape');
                        $(".img").css("height", visina_tr + "px");
                        //$(".img").css("margin-left", ($("#" + selector).width() / 2) - ($("#" + selector + " img").width() / 2) + "px");
                        break;
                    default:
                        // alert('portrait');
                        $(".img").css("height", visina_tr + "px");
                        //$(".img").css("margin-left", ($("#" + selector).width() / 2) - ($("#" + selector + " img").width() / 2) + "px");
                        break;
                }
            }
            window.addEventListener('orientationchange', doOnOrientationChange);

            function setup_krogcev()
            {
                $("table tr td").each(function() {
                    $(this).html("");
                });
                // setup krogcev
                //beli
                var visina_tr = ($(window).height() - $(window).height() * 0.05) / 8;
                var z_x = 5;
                var z_y = 0;
                for (var i = 0; i < 12; i++)
                {
                    var selector = "p_" + z_x + z_y;
                    $("#" + selector).html('<img onclick="click_dame(' + z_x + ',' + z_y + ',1,1)" data-barva="1" class="img" src="imgs/beli.png" alt="beli" />');

                    if (z_y === 7)//gre v novo vrstico
                    {
                        z_y = 0;
                        z_x++;
                    }
                    else if (z_y === 6)//gre v novo vrstico
                    {
                        z_y = 1;
                        z_x++;
                    }
                    else
                        z_y += 2;//naslednji
                }
                //crni
                var z_x = 0;
                var z_y = 1;
                for (var i = 0; i < 12; i++)
                {
                    var selector = "p_" + z_x + z_y;

                    $("#" + selector).html('<img onclick="click_dame(' + z_x + ',' + z_y + ',1,2)" data-barva="2" class="img" data-tip="1"  src="imgs/crni.png" alt="crni" />');

                    if (z_y === 7)//gre v novo vrstico
                    {
                        z_y = 0;
                        z_x++;
                    }
                    else if (z_y === 6)//gre v novo vrstico
                    {
                        z_y = 1;
                        z_x++;
                    }
                    else
                        z_y += 2;//naslednji
                }
                $(".img").css("height", visina_tr + "px");
                //$(".img").css("margin-left", ($("#" + selector).width() / 2) - ($("#" + selector + " img").width() / 2) + "px");
                ///---------------------------------------
            }

            $(document).ready(function() {
                na_vrsti_display();
                // menu_show();

                $("table tr").css("height", ($(window).height() - $(window).height() * 0.05) / 8);


                setup_krogcev();
                $("#p_30").html('<img onclick="click_dame(3,0,1,1)" data-barva="1" class="img" data-tip="1"  src="imgs/beli.png" alt="beli" />');
                $("#p_32").html('<img onclick="click_dame(3,2,1,1)" data-barva="1" class="img" data-tip="1"  src="imgs/beli.png" alt="beli" />');

                //$("#p_43").html('<img onclick="click_dame(4,3,1,2)" data-barva="2" class="img" data-tip="1"  src="imgs/crni.png" alt="crni" />');

            });
            function nova_click(event)
            {
                event.preventDefault();
                alert("no");
            }
            function predaja_click(event)
            {
                event.preventDefault();
                alert("no");
            }
            function neodloceno_click(event)
            {
                event.preventDefault();
                alert("no");
            }

            function preveri_barvo(selector)
            {
                if ($("#" + selector).find(".img").length)
                {
                    return $("#" + selector).find(".img").attr("data-barva");
                }
                else
                    return -1;
            }
            var pobarvani = false;
            var kliknjen_x = -1;
            var kliknjen_y = -1;
            var obarvani = [false, false, false, false];

            function click_dame(x, y, tip, barva)
            {
                var visina_tr = (($(window).height() - $(window).height() * 0.05) / 8) - 2;

                if (pobarvani === false)
                {
                    if (parseInt(tip) === 1 && na_vrsti === 1 && parseInt(barva) === 1)//navadna dama, bela-------------------------------------------------------------------------
                    {
                        var selector1 = "p_" + (parseInt(x) - 1) + (parseInt(y) - 1);//levo gor
                        var x1 = parseInt(x) - 1;
                        var y1 = parseInt(y) - 1;
                        var selector2 = "p_" + (parseInt(x) - 1) + (parseInt(y) + 1);//desno gor
                        var x2 = parseInt(x) - 1;
                        var y2 = parseInt(y) + 1;

                        var noben_pobarvan = false;
                        if ($("#" + selector1).html() === "")
                        {
                            $("#" + selector1).html('<div onclick="premik(' + x1 + ',' + y1 + ')" style="height:' + visina_tr + 'px;" class="img_ozadje"  ></div>');
                            obarvani[0] = true;
                            noben_pobarvan = true;
                        }
                        else//levo gor je zasedeno
                        {
                            var barva = preveri_barvo(selector1);
                            if (parseInt(barva) === 2)//levo gor je nasprotnikov
                            {
                                var selector3 = "p_" + (parseInt(x) - 2) + (parseInt(y) - 2);//levo gor
                                var x1 = parseInt(x) - 2;
                                var y1 = parseInt(y) - 2;
                                if ($("#" + selector3).html() === "")// 2 POLJA DIAGONALNO LEVO JE PRAZNO
                                {
                                    $("#" + selector3).html('<div onclick="premik(' + x1 + ',' + y1 + ')" style="height:' + visina_tr + 'px;" class="img_ozadje"  ></div>');
                                    obarvani[0] = true;
                                    noben_pobarvan = true;
                                }
                            }
                        }
                        if ($("#" + selector2).html() === "")
                        {
                            $("#" + selector2).html('<div onclick="premik(' + x2 + ',' + y2 + ')" style="height:' + visina_tr + 'px;" class="img_ozadje"  ></div>');
                            obarvani[1] = true;
                            noben_pobarvan = true;
                        }
                        else
                        {
                            var barva = preveri_barvo(selector2);
                            if (parseInt(barva) === 2)//desno gor je nasprotnikov
                            {
                                var selector3 = "p_" + (parseInt(x) - 2) + (parseInt(y) + 2);//desno gor
                                var x2 = parseInt(x) - 2;
                                var y2 = parseInt(y) + 2;
                                if ($("#" + selector3).html() === "")// 2 POLJA DIAGONALNO DESNO JE PRAZNO
                                {
                                    $("#" + selector3).html('<div onclick="premik(' + x2 + ',' + y2 + ')" style="height:' + visina_tr + 'px;" class="img_ozadje"  ></div>');
                                    obarvani[1] = true;
                                    noben_pobarvan = true;
                                }
                            }
                        }
                        if (noben_pobarvan)
                        {
                            pobarvani = true;
                            kliknjen_x = x;
                            kliknjen_y = y;
                        }
                    }
                    if (parseInt(tip) === 1 && na_vrsti === 2 && parseInt(barva) === 2)//navadna dama,crna---------------------------------------------------------------------------------
                    {
                        var selector1 = "p_" + (parseInt(x) + 1) + (parseInt(y) - 1);//levo dol
                        var x1 = parseInt(x) + 1;
                        var y1 = parseInt(y) - 1;
                        var selector2 = "p_" + (parseInt(x) + 1) + (parseInt(y) + 1);//desno dol
                        var x1 = parseInt(x) + 1;
                        var y1 = parseInt(y) + 1;

                        var noben_pobarvan = false;
                        if ($("#" + selector1).html() === "")
                        {
                            $("#" + selector1).html('<div onclick="premik(' + x1 + ',' + y1 + ')" style="height:' + visina_tr + 'px;" class="img_ozadje"  ></div>');
                            obarvani[2] = true;
                            noben_pobarvan = true;
                        }
                        else//levo gor je zasedeno
                        {
                            var barva = preveri_barvo(selector1);
                            if (parseInt(barva) === 1)//levo gor je nasprotnikov
                            {
                                var selector3 = "p_" + (parseInt(x) + 2) + (parseInt(y) - 2);//levo gor
                                var x1 = parseInt(x) + 2;
                                var y1 = parseInt(y) - 2;
                                if ($("#" + selector3).html() === "")// 2 POLJA DIAGONALNO LEVO JE PRAZNO
                                {
                                    $("#" + selector3).html('<div onclick="premik(' + x1 + ',' + y1 + ')" style="height:' + visina_tr + 'px;" class="img_ozadje"  ></div>');
                                    obarvani[2] = true;
                                    noben_pobarvan = true;
                                }
                            }
                        }
                        if ($("#" + selector2).html() === "")
                        {
                            $("#" + selector2).html('<div onclick="premik(' + x2 + ',' + y2 + ')" style="height:' + visina_tr + 'px;" class="img_ozadje"  ></div>');
                            obarvani[3] = true;
                            noben_pobarvan = true;
                        }
                        else//levo gor je zasedeno
                        {
                            var barva = preveri_barvo(selector2);
                            if (parseInt(barva) === 1)//levo gor je nasprotnikov
                            {
                                var selector3 = "p_" + (parseInt(x) + 2) + (parseInt(y) + 2);//levo gor
                                var x2 = parseInt(x) + 2;
                                var y2 = parseInt(y) + 2;
                                if ($("#" + selector3).html() === "")// 2 POLJA DIAGONALNO LEVO JE PRAZNO
                                {
                                    $("#" + selector3).html('<div onclick="premik(' + x2 + ',' + y2 + ')" style="height:' + visina_tr + 'px;" class="img_ozadje"  ></div>');
                                    obarvani[3] = true;
                                    noben_pobarvan = true;
                                }
                            }
                        }
                        if (noben_pobarvan)
                        {
                            pobarvani = true;
                            kliknjen_x = x;
                            kliknjen_y = y;
                        }

                    }
                    else//lahko gre nazaj
                    {//////// TOOOOOOOOOOOOOODDDDOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
                    }

                }
                else if (kliknjen_x === parseInt(x) && kliknjen_y === parseInt(y))//kliknjen je isti --------------------izbris pobarvanja---------------------------------------------
                {
                    // alert(kliknjen_x + " " + x + "-" + kliknjen_y + " " + y);
                    if (parseInt(tip) === 1 && na_vrsti === 1 && parseInt(barva) === 1)//navadna dama, bela
                    {

                        var selector1 = "p_" + (parseInt(x) - 1) + (parseInt(y) - 1);//levo gor
                        var selector2 = "p_" + (parseInt(x) - 1) + (parseInt(y) + 1);//desno gor
                        if (obarvani[0] && preveri_barvo(selector1) === -1)//LEVO GOR JE PRAZNO POLJE
                            $("#" + selector1).html('');
                        else if (obarvani[0])//2 polja levo diagonalno
                        {
                            var selector3 = "p_" + (parseInt(x) - 2) + (parseInt(y) - 2);//levo gor
                            if (preveri_barvo(selector3) === -1)// 2 POLJA DIAGONALNO LEVO JE PRAZNO
                            {
                                $("#" + selector3).html('');
                            }
                        }


                        if (obarvani[1] && preveri_barvo(selector2) === -1)
                            $("#" + selector2).html('');
                        else if (obarvani[1])//2 polja levo diagonalno
                        {
                            var selector3 = "p_" + (parseInt(x) - 2) + (parseInt(y) + 2);//levo gor
                            if (preveri_barvo(selector3) === -1)// 2 POLJA DIAGONALNO LEVO JE PRAZNO
                            {
                                $("#" + selector3).html('');
                            }
                        }
                        //reset vsega
                        pobarvani = false;
                        kliknjen_x = -1;
                        kliknjen_y = -1;
                        obarvani[0] = false;
                        obarvani[1] = false;
                    }
                    if (parseInt(tip) === 1 && na_vrsti === 2 && parseInt(barva) === 2)//navadna dama,crna
                    {
                        var selector1 = "p_" + (parseInt(x) + 1) + (parseInt(y) - 1);//levo dol
                        var selector2 = "p_" + (parseInt(x) + 1) + (parseInt(y) + 1);//desno dol
                        if (obarvani[2] && preveri_barvo(selector1) === -1)
                            $("#" + selector1).html('');
                        else if (obarvani[2])//2 polja levo diagonalno
                        {
                            var selector3 = "p_" + (parseInt(x) + 2) + (parseInt(y) - 2);//levo gor
                            if (preveri_barvo(selector3) === -1)// 2 POLJA DIAGONALNO LEVO JE PRAZNO
                            {
                                $("#" + selector3).html('');
                            }
                        }


                        if (obarvani[3] && preveri_barvo(selector2) === -1)
                            $("#" + selector2).html('');
                        else if (obarvani[3])//2 polja levo diagonalno
                        {
                            var selector3 = "p_" + (parseInt(x) + 2) + (parseInt(y) + 2);//levo gor
                            if (preveri_barvo(selector3) === -1)// 2 POLJA DIAGONALNO LEVO JE PRAZNO
                            {
                                $("#" + selector3).html('');
                            }
                        }

                        //reset vsega
                        pobarvani = false;
                        kliknjen_x = -1;
                        kliknjen_y = -1;
                        obarvani[2] = false;
                        obarvani[3] = false;
                    }
                    else//lahko gre nazaj
                    {//////// TOOOOOOOOOOOOOODDDDOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
                    }
                }
            }




        </script>


    </head>

    <body onload="init()"> 

        <div data-role="page"  style="overflow-x:visible; " id="page1">
            <!--<div data-role="header">
                <h1>Dama</h1>
                <button id="klik">gumb</button>
            </div>-->
            <div role="main" class="ui-content">
                <table>
                    <tr><td id="p_00"></td><td id="p_01"></td><td id="p_02"></td><td id="p_03"></td><td id="p_04"></td><td id="p_05"></td><td id="p_06" ></td><td id="p_07"></td></tr>
                    <tr><td id="p_10"></td><td id="p_11"></td><td id="p_12"></td><td id="p_13"></td><td id="p_14"></td><td id="p_15"></td><td id="p_16" ></td><td id="p_17"></td></tr>
                    <tr><td id="p_20"></td><td id="p_21"></td><td id="p_22"></td><td id="p_23"></td><td id="p_24"></td><td id="p_25"></td><td id="p_26" ></td><td id="p_27"></td></tr>
                    <tr><td id="p_30"></td><td id="p_31"></td><td id="p_32"></td><td id="p_33"></td><td id="p_34"></td><td id="p_35"></td><td id="p_36" ></td><td id="p_37"></td></tr>
                    <tr><td id="p_40"></td><td id="p_41"></td><td id="p_42"></td><td id="p_43"></td><td id="p_44"></td><td id="p_45"></td><td id="p_46" ></td><td id="p_47"></td></tr>
                    <tr><td id="p_50"></td><td id="p_51"></td><td id="p_52"></td><td id="p_53"></td><td id="p_54"></td><td id="p_55"></td><td id="p_56" ></td><td id="p_57"></td></tr>
                    <tr><td id="p_60"></td><td id="p_61"></td><td id="p_62"></td><td id="p_63"></td><td id="p_64"></td><td id="p_65"></td><td id="p_66" ></td><td id="p_67"></td></tr>
                    <tr><td id="p_70"></td><td id="p_71"></td><td id="p_72"></td><td id="p_73"></td><td id="p_74"></td><td id="p_75"></td><td id="p_76" ></td><td id="p_77"></td></tr>

                </table>
            </div>
        </div>
        <!-- <div data-role="page" id="page2">
            <div data-role="header">
                <h1>Page 2</h1>
            </div>
            <div role="main" class="ui-content">
                <a href="#page1" data-rel="back" data-transition="slide" class="ui-btn ui-corner-all ui-btn-inline">Go Back To Page 1</a>
            </div>
        </div>-->


        <div data-displayed="0" id="menu" data-role="none"  >
            <ul >
                <li onclick="nova_click(event)"  ><a href="#">Nova igra</a></li>
                <li onclick="predaja_click(event)"  ><a href="#">Predaja</a></li>
                <li onclick="neodloceno_click(event)" ><a href="#">Neodločeno</a></li>
            </ul>
        </div>
        <div class="popup" id="predaja_confirm" >
            <h6>Igralec <span id="igralec_predaja"></span> se predaja, sprejmeš predajo? </h6>
            <button id="yes">Da</button>  <button id="no">Ne</button>
        </div>
        <div class="popup" id="neodloceno_confirm" >
            <h6>Igralec <span id="igralec_predaja"></span> igro razglaša za neodločeno, sprejmeš? </h6>
            <button id="yes">Da</button>  <button id="no">Ne</button>
        </div>

        <div id="na_vrsti_je"><p>Na vrsti je: <span id="igralec" ></span></p></div>
    </body>

</html>